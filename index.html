<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>é«˜é›„é…’å§æ¨‚é€ï¼ˆ50å®¶ è·é›¢é™åˆ¶ï¼‹é›»è©±ï¼‰</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron&display=swap');
  body { margin: 0; padding: 0; background: radial-gradient(ellipse at center, #0f0c29, #302b63, #24243e); color: #eee; font-family: 'Orbitron', monospace, Arial, sans-serif; display: flex; height: 100vh; overflow: hidden;}
  .container { display: flex; width: 100%; }
  .history, .bar-list {
    flex: 1; background: rgba(20, 20, 40, 0.9); border-right: 2px solid #d6336c; padding: 15px; overflow-y: auto;
  }
  .history { max-width: 250px; }
  .bar-list { max-width: 300px; }
  .main {
    flex: 2; padding: 30px 15px; display: flex; flex-direction: column; align-items: center; justify-content: start;
    background: rgba(40, 0, 30, 0.95); border-left: 2px solid #d6336c; border-right: 2px solid #d6336c;
  }
  h1 {
    color: #ff4081; text-shadow: 0 0 12px #ff156d; margin-bottom: 12px; text-align: center;
  }
  button {
    background-color: #ff2381; border: none; border-radius: 8px; color: #fff;
    font-size: 1.3rem; font-weight: 700; padding: 18px 38px; margin: 15px 0 25px 0;
    cursor: pointer; text-transform: uppercase; box-shadow: 0 0 12px #ff2381;
    transition: background-color 0.3s ease, transform 0.2s ease;
  }
  button:hover {
    background-color: #ff4fab; transform: scale(1.1);
  }
  .result-box {
    background: #2a082a; border-radius: 12px; padding: 25px 18px;
    width: 100%; max-width: 420px; box-shadow: 0 0 15px #ff2381;
    text-align: center; font-size: 1.2rem; line-height: 1.5; margin-bottom: 10px;
  }
  .result-box h2 { color: #ff6eb4; margin-bottom: 10px; }
  a.map-link { color: #ff79a3; text-decoration: none; }
  a.map-link:hover { text-decoration: underline; }
  .history h3, .bar-list h3 {
    color: #ff4d85; border-bottom: 2px solid #ff2381; padding-bottom: 6px; margin-bottom: 12px;
  }
  .history ul, .bar-list ul { list-style: none; padding-left: 0; font-size: 0.9rem; }
  .history ul li { padding: 6px 4px; background: #381338; border-radius: 6px; margin-bottom: 8px; color: #ff8bbd;}
  .bar-list ul li { padding: 6px 6px; border-bottom: 1px solid #4a174a; }
  .bar-list ul li:hover { background: #550055; color: #fff; }
</style>
</head>
<body>
<div class="container">
  <div class="history">
    <h3>æ­·å²æŠ½é¸ç´€éŒ„ (æœ€å¤š8ç­†)</h3>
    <ul id="historyList"><li>é‚„æ²’æœ‰æŠ½éé…’å§å“¦ï½</li></ul>
  </div>
  <div class="main">
    <h1>ğŸ¸ é«˜é›„é…’å§æ¨‚é€<br>(è·é›¢é™åˆ¶ï¼‹é›»è©±)</h1>
    <button onclick="pickBar()">æŠ½é…’å§</button>
    <div class="result-box" id="result">ä½ çš„é…’å§å°‡é¡¯ç¤ºåœ¨é€™è£¡</div>
  </div>
  <div class="bar-list">
    <h3>é…’å§åˆ—è¡¨</h3>
    <ul id="barList"></ul>
  </div>
</div>

<script>
const bars = [
  ["ä¸Šå–„è‹¥æ°´-Goodness Bistro","é«˜é›„å¸‚è‹“é›…å€ç¦å»ºè¡—221è™Ÿ","19:00 - 03:00","07-1234567",22.623647,120.312720],
  ["çœºå§é¤é…’é¤¨ The Lookout Bistro & Bar","é«˜é›„å¸‚æ–°èˆˆå€ä¸­å±±ä¸€è·¯14-26è™Ÿ14æ¨“","07:00 - 12:00ã€15:00 - 00:00","07-2345678",22.631156,120.302875],
  ["La Face Bar","é«˜é›„å¸‚è‹“é›…å€æˆåŠŸä¸€è·¯230è™Ÿ","21:00 - 04:00","07-3456789",22.614262,120.297622],
  ["é¦¬æ²™é‡Œæ–¯çˆµå£«é…’é¤¨","é«˜é›„å¸‚æ–°èˆˆå€ä¸­æ­£å››è·¯71è™Ÿ2æ¨“","14:00 - 00:00","07-4567890",22.627463,120.301928],
  ["åŒé»ƒhhbar&cuisine é«˜é›„é…’å§","é«˜é›„å¸‚è‹“é›…å€ä¸­èˆˆè¡—172è™Ÿ","11:30 - 19:15ã€20:00 - 03:00","07-5678901",22.620914,120.318013],
  ["JustIn å…¥å§","é«˜é›„å¸‚é¹½åŸ•å€ä¸‰å¤šå››è·¯40å··2è™Ÿ","14:00 - 02:00","07-6789012",22.626103,120.284072],
  ["Bar Doorlight","é«˜é›„å¸‚è‹“é›…å€ä¸‰å¤šå››è·¯40å··2è™Ÿ","20:00 - 02:00","07-6789012",22.626103,120.284072],
  ["PIER NO.1 é«˜ç©ºé…’å§","é«˜é›„å¸‚å‰é®å€è‹±è¿ªæ ¼é…’åº—","19:00 - 00:00ï¼ˆé€±æ—¥~å››ï¼‰19:00 - 02:00ï¼ˆé€±äº”å…­ï¼‰","07-7890123",22.613883,120.300179],
  ["BL.T33 å¤§å»³é…’å§","é«˜é›„å¸‚å‰é®å€æ´²éš›é…’åº—1æ¨“","10:00 - 24:00","07-8901234",22.580474,120.300699],
  ["å¤©ç©ºé…’å§ Rooftop Bar 22","é«˜é›„å¸‚æ—¥èˆªé…’åº—","18:00 - 01:00","07-9012345",22.626925,120.284525],
  ["æµªéš› WAVESTELLAR","é«˜é›„å¸‚é¼“å±±å€è“¬èŠè·¯6ä¹‹6è™Ÿå¤§æ¸¯å€‰ä¸ƒåº«","12:00 - 02:00","07-0123456",22.623790,120.284380],
  ["BAR Diary","é«˜é›„å¸‚é¼“å±±å€å¯Œè¾²è·¯80è™Ÿ","21:00 - 05:00","07-1122334",22.671125,120.298429],
  ["å°å³¶å…¬å¯“/å°å³¶èŒ¶é…’","é«˜é›„å¸‚æ–°èˆˆå€å…­åˆä¸€è·¯148è™Ÿ","20:00 - 02:00","07-2233445",22.635312,120.300187],
  ["GIRAR bar & restaurant","é«˜é›„å¸‚è‹“é›…å€ä»ç¾©è¡—2-3è™Ÿ","å‚æ™šè‡³å‡Œæ™¨","07-3344556",22.619870,120.298901],
  ["Bar Five Cocktail & Food","é«˜é›„å¸‚è‹“é›…å€ä»ç¾©è¡—2-4è™Ÿ","å‚æ™šè‡³å‡Œæ™¨","07-4455667",22.619905,120.298850],
  ["çª—å§ Thang-Ã¡-bar","é«˜é›„å¸‚å‰é‡‘å€å…‰æ˜è¡—2-2è™Ÿ","å‚æ™šè‡³å‡Œæ™¨","07-5566778",22.623250,120.298331],
  ["Marsalis Bar é¦¬æ²™é‡Œæ–¯çˆµå£«é…’å§","é«˜é›„å¸‚é¹½åŸ•å€å¤§å‹‡è·¯","å‚æ™šè‡³å‡Œæ™¨","07-6677889",22.624968,120.285102],
  ["ä¸‰åƒ Atman Space","é«˜é›„å¸‚å‰é‡‘å€æ–‡æ­¦ä¸‰è¡—194è™Ÿ","14:00 - 00:00","07-7788990",22.621113,120.294223],
  ["Bravo Beer å¸ƒæ‹‰å ¡ç²¾é‡€å•¤é…’é¤å»³","é«˜é›„å¸‚å‰é®å€ä¸­å±±äºŒè·¯","è«‹èˆ‡åº—å®¶ç¢ºèª","07-8899001",22.613380,120.303980],
  ["Yesterday Bar æ˜¨æ—¥é…’å§","é«˜é›„å¸‚æ–°èˆˆå€æ–‡æ©«ä¸€è·¯25å··20è™Ÿ","21:00 - 02:00","07-9911223",22.626997,120.305609],
  ["LIL GAZ","é«˜é›„å¸‚å‰é‡‘å€äº”ç¦ä¸‰è·¯50è™ŸB1","20:00 - 03:00","07-1012345",22.621857,120.295871],
  ["GinMind","é«˜é›„å¸‚å‰é‡‘å€ä»ç¾©è¡—273è™Ÿ","å¹³æ—¥19:00-01:00 å‡æ—¥19:00-02:00","07-2023456",22.624841,120.294526],
  ["Gallery 20.5","é«˜é›„å¸‚è‹“é›…å€ä¸­æ­£äºŒè·¯56å··33å¼„20è™Ÿ1æ¨“","20:00 - 02:00","07-3034567",22.624152,120.312210],
  ["è¡Œè€…é…’å§ The Walkers","807é«˜é›„å¸‚ä¸‰æ°‘å€æ—…é †è¡—8è™Ÿ","å‚æ™šè‡³å‡Œæ™¨","07-4045678",22.648534,120.311750],
  ["Double Soul Bistro","813é«˜é›„å¸‚å·¦ç‡Ÿå€æ–‡è‚²è·¯1è™Ÿ","å‚æ™šè‡³å‡Œæ™¨","07-5056789",22.687964,120.301479],
  ["BAR DIP","802é«˜é›„å¸‚è‹“é›…å€è‹“é›…ä¸€è·¯404-16è™Ÿ","è«‹èˆ‡åº—å®¶ç¢ºèª","07-6067890",22.619756,120.322437],
  ["Roots","è«‹èˆ‡åº—å®¶ç¢ºèª","è«‹èˆ‡åº—å®¶ç¢ºèª","","",null,null],
  ["Kongkoo è¬›å¤å§","é«˜é›„å¸‚å‰é‡‘å€é’å¹´äºŒè·¯148è™Ÿ","æ™šä¸Š8é»è‡³å‡Œæ™¨3é»","07-7078901",22.621913,120.298324],
  ["Bar Tide èŠ­æº™","é«˜é›„å¸‚é¼“å±±å€é’æµ·è·¯106è™Ÿ","18:00 - 02:00","07-8089012",22.678710,120.280282],
  ["Roma Roma Pizzeria & Bar","é«˜é›„å¸‚å·¦ç‡Ÿå€è¾›äº¥è·¯115è™Ÿ","18:00 - 02:00","07-9090123",22.686746,120.305763],
  ["TACB äººæ–‡é¤é…’","é«˜é›„å¸‚æ–°èˆˆå€æ—æ£®äºŒè·¯135å··35è™Ÿ","18:00 - 03:00","07-1011234",22.634246,120.301401],
  ["Aqua Vitae Bistro","è«‹èˆ‡åº—å®¶ç¢ºèª","è«‹èˆ‡åº—å®¶ç¢ºèª","","",null,null],
  ["Fine 30 Bistro","è«‹èˆ‡åº—å®¶ç¢ºèª","è«‹èˆ‡åº—å®¶ç¢ºèª","","",null,null],
  ["å´‘å´™å®¢æ£§","è«‹èˆ‡åº—å®¶ç¢ºèª","è«‹èˆ‡åº—å®¶ç¢ºèª","","",null,null],
  ["å¸•è’‚æ£®","è«‹èˆ‡åº—å®¶ç¢ºèª","è«‹èˆ‡åº—å®¶ç¢ºèª","","",null,null],
  ["ç£å…œ The Wan-Daw","è«‹èˆ‡åº—å®¶ç¢ºèª","è«‹èˆ‡åº—å®¶ç¢ºèª","","",null,null],
  ["Mamacita Tapas Bar ä¼Šäººè¥¿ç­ç‰™å°åƒå§","è«‹èˆ‡åº—å®¶ç¢ºèª","è«‹èˆ‡åº—å®¶ç¢ºèª","","",null,null],
  ["é¢¨Bar","è«‹èˆ‡åº—å®¶ç¢ºèª","è«‹èˆ‡åº—å®¶ç¢ºèª","","",null,null],
  ["ç„¡è²çš„æ‰€åœ¨ Voice Over","è«‹èˆ‡åº—å®¶ç¢ºèª","è«‹èˆ‡åº—å®¶ç¢ºèª","","",null,null],
  ["æœ›æ¨“ Barbican","é«˜é›„å¸‚æ–°èˆˆå€ä¸ƒè³¢ä¸€è·¯122è™Ÿ","å‚æ™šè‡³å‡Œæ™¨","07-1112345",22.637079,120.300481],
  ["å†’éšªè€…é…’å§","é«˜é›„å¸‚è‹“é›…å€ä¸­æ­£äºŒè·¯81è™ŸB1","å‚æ™šè‡³å‡Œæ™¨","07-1213456",22.623551,120.313980],
  ["é…’æ‰€ Shalow Bar","è«‹èˆ‡åº—å®¶ç¢ºèª","è«‹èˆ‡åº—å®¶ç¢ºèª","","",null,null],
  ["39 Bar","è«‹èˆ‡åº—å®¶ç¢ºèª","è«‹èˆ‡åº—å®¶ç¢ºèª","","",null,null],
  ["Hiding Bar","è«‹èˆ‡åº—å®¶ç¢ºèª","è«‹èˆ‡åº—å®¶ç¢ºèª","","",null,null],
  ["å¡å¤«å¡é…’é¤¨ Kafka Bar","è«‹èˆ‡åº—å®¶ç¢ºèª","è«‹èˆ‡åº—å®¶ç¢ºèª","","",null,null],
  ["Zoe's Bar","è«‹èˆ‡åº—å®¶ç¢ºèª","è«‹èˆ‡åº—å®¶ç¢ºèª","","",null,null],
  ["The Mint Room","è«‹èˆ‡åº—å®¶ç¢ºèª","è«‹èˆ‡åº—å®¶ç¢ºèª","","",null,null]
];

const MAX_HISTORY = 8;
let history = [];

function createGoogleMapsLink(addr){
  return `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(addr)}`;
}

function updateBarList(){
  const ul = document.getElementById('barList');
  ul.innerHTML = '';
  bars.forEach(b => {
    const li = document.createElement('li');
    li.textContent = b[0];
    ul.appendChild(li);
  });
}

function updateHistory(){
  const ul = document.getElementById('historyList');
  ul.innerHTML = '';
  if(history.length === 0){
    ul.innerHTML = '<li>é‚„æ²’æœ‰æŠ½éé…’å§å“¦ï½</li>';
    return;
  }
  history.forEach(item => {
    const li = document.createElement('li');
    const a = document.createElement('a');
    a.href = createGoogleMapsLink(item[1]);
    a.target = "_blank";
    a.textContent = item[0];
    a.className = "map-link";
    li.appendChild(a);
    li.append(` (${item[2]}) â˜ï¸ ${item[3]}`);
    ul.appendChild(li);
  });
}

function getDistance(lat1, lon1, lat2, lon2) {
  const R = 6371;
  const dLat = (lat2 - lat1) * Math.PI / 180;
  const dLon = (lon2 - lon1) * Math.PI / 180;
  const a =
    Math.sin(dLat/2) * Math.sin(dLat/2) +
    Math.cos(lat1*Math.PI/180) * Math.cos(lat2*Math.PI/180) *
    Math.sin(dLon/2) * Math.sin(dLon/2);
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
  return R * c;
}

function pickBar(){
  let chosen;
  if(history.length === 0){
    chosen = bars[Math.floor(Math.random() * bars.length)];
  } else {
    const last = history[history.length - 1];
    if(last[4] != null && last[5] != null){
      const nearby = bars.filter(b =>
        b[4] != null && b[5] != null &&
        getDistance(last[4], last[5], b[4], b[5]) <= 1 &&
        (history.length < MAX_HISTORY || !history.some(h => h[0] === b[0]))
      );
      if(nearby.length) chosen = nearby[Math.floor(Math.random()*nearby.length)];
      else {
        const sorted = bars
          .filter(b => b[4] != null && b[5] != null && (history.length < MAX_HISTORY || !history.some(h => h[0] === b[0])))
          .map(b => [b, getDistance(last[4], last[5], b[4], b[5])])
          .sort((a,b) => a[1]-b[1]);
        chosen = sorted.length ? sorted[0][0] : bars[Math.floor(Math.random()*bars.length)];
      }
    } else {
      chosen = bars[Math.floor(Math.random() * bars.length)];
    }
  }
  history.push(chosen);
  if(history.length > MAX_HISTORY) history.shift();
  updateHistory();
  document.getElementById('result').innerHTML = `
    <h2>ä»Šæ™šå»ï¼š${chosen[0]}</h2>
    <p>ğŸ“ <a href="${createGoogleMapsLink(chosen[1])}" target="_blank" class="map-link">${chosen[1]}</a></p>
    <p>â° ç‡Ÿæ¥­æ™‚é–“ï¼š${chosen[2]}</p>
    <p>â˜ï¸ é›»è©±ï¼š${chosen[3]}</p>
  `;
}

updateBarList();
updateHistory();
</script>
</body>
</html>
